<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.collections.FXCollections?>
<?import java.lang.String?>

<BorderPane xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" 
            fx:controller="controller.DashboardController"
            style="-fx-background-color: #f5f5f5;">
    
    <!-- Header -->
    <top>
        <HBox style="-fx-background-color: #8CC1E9; -fx-padding: 20 40;" alignment="CENTER_LEFT" spacing="20">
            <HBox alignment="CENTER_LEFT" spacing="15">
                <Label text="COZIFY" style="-fx-font-size: 24; -fx-font-weight: bold; -fx-text-fill: white;"/>
            </HBox>
            
            <Region HBox.hgrow="ALWAYS"/>
            
            <!-- Switch -->
            <HBox spacing="10" alignment="CENTER">
                <Button fx:id="btnSwitchToAdmin" text="ðŸ‘¨â€ðŸ’¼ Admin" onAction="#handleSwitchToAdmin"
                        style="-fx-background-color: white; -fx-text-fill: #8CC1E9; -fx-padding: 8 16; -fx-background-radius: 20;"/>
                <Button fx:id="btnSwitchToOwner" text="ðŸ  Pemilik Kos" onAction="#handleSwitchToOwner"
                        style="-fx-background-color: rgba(255,255,255,0.3); -fx-text-fill: white; -fx-padding: 8 16; -fx-background-radius: 20;"/>
            </HBox>
            
            <!-- Badge -->
            <VBox alignment="CENTER_RIGHT">
                <Label fx:id="lblCurrentRole" text="ðŸ‘¨â€ðŸ’¼ ADMIN" 
                       style="-fx-background-color: rgba(255,255,255,0.2); -fx-text-fill: white; -fx-padding: 8 16; -fx-background-radius: 20;"/>
            </VBox>
        </HBox>
    </top>
    
    <!-- Content -->
    <center>
        <StackPane>
            
            <!-- ADMIN DASHBOARD -->
            <VBox fx:id="adminDashboard" spacing="30" style="-fx-padding: 30 40;">
                
                <!-- Admin -->
                <GridPane hgap="20" vgap="20">
                    <VBox style="-fx-background-color: white; -fx-background-radius: 10; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);" GridPane.columnIndex="0">
                        <Label text="Menunggu Verifikasi" style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                        <Label fx:id="lblPendingCount" text="0" style="-fx-font-size: 32; -fx-font-weight: bold; -fx-text-fill: #FF9800;">
                            <padding><Insets top="10"/></padding>
                        </Label>
                    </VBox>
                    
                    <VBox style="-fx-background-color: white; -fx-background-radius: 10; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);" GridPane.columnIndex="1">
                        <Label text="Terverifikasi" style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                        <Label fx:id="lblVerifiedCount" text="0" style="-fx-font-size: 32; -fx-font-weight: bold; -fx-text-fill: #4CAF50;">
                            <padding><Insets top="10"/></padding>
                        </Label>
                    </VBox>
                    
                    <VBox style="-fx-background-color: white; -fx-background-radius: 10; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);" GridPane.columnIndex="2">
                        <Label text="Ditolak" style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                        <Label fx:id="lblRejectedCount" text="0" style="-fx-font-size: 32; -fx-font-weight: bold; -fx-text-fill: #f44336;">
                            <padding><Insets top="10"/></padding>
                        </Label>
                    </VBox>
                    
                    <VBox style="-fx-background-color: white; -fx-background-radius: 10; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);" GridPane.columnIndex="3">
                        <Label text="Total Pemilik Kos" style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                        <Label fx:id="lblTotalOwners" text="0" style="-fx-font-size: 32; -fx-font-weight: bold; -fx-text-fill: #2196F3;">
                            <padding><Insets top="10"/></padding>
                        </Label>
                    </VBox>
                </GridPane>
                
                <!-- Admin Tab Pane -->
                <TabPane tabClosingPolicy="UNAVAILABLE" VBox.vgrow="ALWAYS">
                    
                    <Tab text="ðŸ‘¥ Data Pemilik Kos">
                        <VBox spacing="20" style="-fx-padding: 20;">
                            <HBox spacing="10">
                                <Button text="ðŸ‘ Lihat Detail" onAction="#handleViewPemilikDetail"
                                        style="-fx-background-color: #2196F3; -fx-text-fill: white; -fx-padding: 10 20; -fx-background-radius: 5;"/>
                                <Button text="âœ“ Verifikasi" onAction="#handleVerifyPemilik"
                                        style="-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-padding: 10 20; -fx-background-radius: 5;"/>
                                <Button text="âœ— Tolak" onAction="#handleRejectPemilik"
                                        style="-fx-background-color: #f44336; -fx-text-fill: white; -fx-padding: 10 20; -fx-background-radius: 5;"/>
                                <Button text="ðŸ—‘ Hapus" onAction="#handleDeletePemilik"
                                        style="-fx-background-color: #9E9E9E; -fx-text-fill: white; -fx-padding: 10 20; -fx-background-radius: 5;"/>
                            </HBox>
                            
                            <TableView fx:id="tblPemilik" VBox.vgrow="ALWAYS"
                                       style="-fx-background-color: white; -fx-background-radius: 10;">
                                <columns>
                                    <TableColumn fx:id="colPemilikId" text="ID" prefWidth="50"/>
                                    <TableColumn fx:id="colPemilikNama" text="Nama Pemilik" prefWidth="200"/>
                                    <TableColumn fx:id="colPemilikEmail" text="Email" prefWidth="200"/>
                                    <TableColumn fx:id="colPemilikPhone" text="No. Telepon" prefWidth="150"/>
                                    <TableColumn fx:id="colPemilikJumlahKos" text="Jumlah Kos" prefWidth="100"/>
                                    <TableColumn fx:id="colPemilikStatus" text="Status" prefWidth="150"/>
                                </columns>
                            </TableView>
                        </VBox>
                    </Tab>
                    
                    <Tab text="ðŸ  Data Kos">
                        <VBox spacing="20" style="-fx-padding: 20;">
                            <HBox spacing="10">
                                <Button text="ðŸ‘ Lihat Detail" onAction="#handleViewKosDetail"
                                        style="-fx-background-color: #2196F3; -fx-text-fill: white; -fx-padding: 10 20; -fx-background-radius: 5;"/>
                                <Button text="âœ“ Verifikasi" onAction="#handleVerifyKos"
                                        style="-fx-background-color: #4CAF50; -fx-text-fill: white; -fx-padding: 10 20; -fx-background-radius: 5;"/>
                                <Button text="âœ— Tolak" onAction="#handleRejectKos"
                                        style="-fx-background-color: #f44336; -fx-text-fill: white; -fx-padding: 10 20; -fx-background-radius: 5;"/>
                            </HBox>
                            
                            <TableView fx:id="tblKos" VBox.vgrow="ALWAYS"
                                       style="-fx-background-color: white; -fx-background-radius: 10;">
                                <columns>
                                    <TableColumn fx:id="colKosId" text="ID" prefWidth="50"/>
                                    <TableColumn fx:id="colKosNama" text="Nama Kos" prefWidth="200"/>
                                    <TableColumn fx:id="colKosPemilik" text="Pemilik" prefWidth="150"/>
                                    <TableColumn fx:id="colKosAlamat" text="Alamat" prefWidth="250"/>
                                    <TableColumn fx:id="colKosHarga" text="Harga/Bulan" prefWidth="150"/>
                                    <TableColumn fx:id="colKosStatus" text="Status" prefWidth="150"/>
                                </columns>
                            </TableView>
                        </VBox>
                    </Tab>
                    
                </TabPane>
                
            </VBox>
            
            <!-- OWNER DASHBOARD -->
            <VBox fx:id="ownerDashboard" spacing="30" style="-fx-padding: 30 40;" visible="false" managed="false">
                
                <!-- Owner -->
                <GridPane hgap="20" vgap="20">
                    
                    <VBox GridPane.columnIndex="0"
                          style="-fx-background-color: white; -fx-background-radius: 10; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);">
                        <Label text="Total Kos" style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                        <Label fx:id="lblTotalKos" text="0"
                               style="-fx-font-size: 32; -fx-font-weight: bold; -fx-text-fill: #2196F3;">
                            <padding><Insets top="10"/></padding>
                        </Label>
                    </VBox>

                    <VBox GridPane.columnIndex="1"
                          style="-fx-background-color: white; -fx-background-radius: 10; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);">
                        <Label text="Total Kamar" style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                        <Label fx:id="lblTotalKamar" text="0"
                               style="-fx-font-size: 32; -fx-font-weight: bold; -fx-text-fill: #4CAF50;">
                            <padding><Insets top="10"/></padding>
                        </Label>
                    </VBox>

                    <VBox GridPane.columnIndex="2"
                          style="-fx-background-color: white; -fx-background-radius: 10; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);">
                        <Label text="Kamar Terisi" style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                        <Label fx:id="lblKamarTerisi" text="0"
                               style="-fx-font-size: 32; -fx-font-weight: bold; -fx-text-fill: #FF9800;">
                            <padding><Insets top="10"/></padding>
                        </Label>
                    </VBox>

                    <VBox GridPane.columnIndex="3"
                          style="-fx-background-color: white; -fx-background-radius: 10; -fx-padding: 20; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);">
                        <Label text="Pendapatan Bulan Ini" style="-fx-font-size: 14; -fx-text-fill: #666;"/>
                        <Label fx:id="lblPendapatan" text="Rp 0"
                               style="-fx-font-size: 32; -fx-font-weight: bold; -fx-text-fill: #9C27B0;">
                            <padding><Insets top="10"/></padding>
                        </Label>
                    </VBox>

                </GridPane>
                
                <!-- Owner Tab Pane -->
                <TabPane tabClosingPolicy="UNAVAILABLE" VBox.vgrow="ALWAYS">

                    <Tab text="ðŸ  Data Kos Saya">
                        <VBox spacing="20" style="-fx-padding: 20;">

                            <HBox spacing="10">
                                <Button text="+ Tambah Kos" onAction="#handleTambahKos"
                                        style="-fx-background-color: #4CAF50; -fx-text-fill: white;"/>
                                <Button text="ðŸ‘ Lihat Detail" onAction="#handleViewDetail"
                                        style="-fx-background-color: #FF9800; -fx-text-fill: white;"/>
                                <Button text="âœ Edit" onAction="#handleEditKos"
                                        style="-fx-background-color: #2196F3; -fx-text-fill: white;"/>
                                <Button text="ðŸ—‘ Hapus" onAction="#handleHapusKos"
                                        style="-fx-background-color: #f44336; -fx-text-fill: white;"/>
                            </HBox>

                            <TableView fx:id="tblMyKos" VBox.vgrow="ALWAYS"
                                       style="-fx-background-color: white; -fx-background-radius: 10;">
                                <columns>
                                    <TableColumn fx:id="colMyKosId" text="ID" prefWidth="50"/>
                                    <TableColumn fx:id="colMyKosNama" text="Nama Kos" prefWidth="200"/>
                                    <TableColumn fx:id="colMyKosAlamat" text="Alamat" prefWidth="250"/>
                                    <TableColumn fx:id="colMyKosHarga" text="Harga/Bulan" prefWidth="150"/>
                                    <TableColumn fx:id="colMyKosTotalKamar" text="Total Kamar" prefWidth="100"/>
                                    <TableColumn fx:id="colMyKosTerisi" text="Terisi" prefWidth="100"/>
                                    <TableColumn fx:id="colMyKosTersedia" text="Tersedia" prefWidth="100"/>
                                </columns>
                            </TableView>
                        </VBox>
                    </Tab>

                    <Tab text="ðŸ’° Laporan Keuangan">
                        <VBox spacing="20" style="-fx-padding: 20;">

                            <VBox spacing="15" 
                                  style="-fx-background-color: white; -fx-padding: 20; -fx-background-radius: 10;">
                                <Label text="Filter Laporan" style="-fx-font-size: 16; -fx-font-weight: bold;"/>

                                <GridPane hgap="15" vgap="10">

                                    <Label text="Periode:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                    <ComboBox prefWidth="200" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                        <items>
                                            <FXCollections fx:factory="observableArrayList">
                                                <String fx:value="Bulan Ini"/>
                                                <String fx:value="Bulan Lalu"/>
                                                <String fx:value="3 Bulan Terakhir"/>
                                                <String fx:value="6 Bulan Terakhir"/>
                                                <String fx:value="Tahun Ini"/>
                                            </FXCollections>
                                        </items>
                                    </ComboBox>

                                    <Label text="Kos:" GridPane.columnIndex="2" GridPane.rowIndex="0"/>
                                    <ComboBox prefWidth="200" GridPane.columnIndex="3" GridPane.rowIndex="0">
                                        <items>
                                            <FXCollections fx:factory="observableArrayList">
                                                <String fx:value="Semua Kos"/>
                                            </FXCollections>
                                        </items>
                                    </ComboBox>

                                    <Button text="ðŸ” Tampilkan" 
                                            GridPane.columnIndex="4" GridPane.rowIndex="0"
                                            style="-fx-background-color: #2196F3; -fx-text-fill: white;"/>
                                </GridPane>
                            </VBox>

                            <HBox spacing="20" 
                                  style="-fx-background-color: linear-gradient(to right, #667eea, #764ba2);
                                         -fx-padding: 25; -fx-background-radius: 10;">
                                <VBox alignment="CENTER" HBox.hgrow="ALWAYS">
                                    <Label text="Total Pemasukan" style="-fx-text-fill: white;"/>
                                    <Label fx:id="lblTotalPemasukan" text="Rp 0"
                                           style="-fx-text-fill: white; -fx-font-size: 24; -fx-font-weight: bold;"/>
                                </VBox>

                                <VBox alignment="CENTER" HBox.hgrow="ALWAYS">
                                    <Label text="Total Pengeluaran" style="-fx-text-fill: white;"/>
                                    <Label fx:id="lblTotalPengeluaran" text="Rp 0"
                                           style="-fx-text-fill: white; -fx-font-size: 24; -fx-font-weight: bold;"/>
                                </VBox>

                                <VBox alignment="CENTER" HBox.hgrow="ALWAYS">
                                    <Label text="Keuntungan Bersih" style="-fx-text-fill: white;"/>
                                    <Label fx:id="lblKeuntungan" text="Rp 0"
                                           style="-fx-text-fill: white; -fx-font-size: 24; -fx-font-weight: bold;"/>
                                </VBox>
                            </HBox>

                            <HBox spacing="10">
                                <Button text="ðŸ–¨ Cetak Laporan" onAction="#handleCetakLaporan"
                                        style="-fx-background-color: #9C27B0; -fx-text-fill: white;"/>
                                <Button text="ðŸ“¥ Export ke Excel" onAction="#handleExportLaporan"
                                        style="-fx-background-color: #00BCD4; -fx-text-fill: white;"/>
                            </HBox>

                            <TableView fx:id="tblLaporan" VBox.vgrow="ALWAYS"
                                       style="-fx-background-color: white; -fx-background-radius: 10;">
                                <columns>
                                    <TableColumn fx:id="colTanggal" text="Tanggal" prefWidth="120"/>
                                    <TableColumn fx:id="colKosLaporan" text="Kos" prefWidth="200"/>
                                    <TableColumn fx:id="colKategori" text="Kategori" prefWidth="150"/>
                                    <TableColumn fx:id="colKeterangan" text="Keterangan" prefWidth="250"/>
                                    <TableColumn fx:id="colPemasukan" text="Pemasukan" prefWidth="150"/>
                                    <TableColumn fx:id="colPengeluaran" text="Pengeluaran" prefWidth="150"/>
                                </columns>
                            </TableView>

                        </VBox>
                    </Tab>

                </TabPane>
                
            </VBox>
            
        </StackPane>
    </center>
    
</BorderPane>